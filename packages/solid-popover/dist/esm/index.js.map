{"version":3,"file":"index.js","sources":["../../src/utils.ts","../../src/PopoverPortal.tsx","../../src/constants.ts","../../src/Popover.tsx","../../src/createArrowContainer.ts","../../src/ArrowContainer.tsx"],"sourcesContent":["import { GetNewPopoverRectProps, PopoverAlign, PopoverPosition } from \"./types\";\n\nexport function createContainer(\n  containerStyle?: Partial<CSSStyleDeclaration>,\n  containerClassName?: string\n) {\n  const container = document.createElement(\"div\");\n  if (containerClassName) container.className = containerClassName;\n  Object.assign(container.style, containerStyle);\n  return container;\n}\n\nexport function rectsAreEqual(rectA: DOMRect, rectB: DOMRect) {\n  return (\n    rectA === rectB ||\n    (rectA?.bottom === rectB?.bottom &&\n      rectA?.height === rectB?.height &&\n      rectA?.left === rectB?.left &&\n      rectA?.right === rectB?.right &&\n      rectA?.top === rectB?.top &&\n      rectA?.width === rectB?.width)\n  );\n}\n\nexport function popoverRectForPosition(\n  position: PopoverPosition,\n  childRect: DOMRect,\n  popoverRect: DOMRect,\n  spacing: number,\n  align: PopoverAlign\n) {\n  const targetMidX = childRect.left + childRect.width / 2;\n  const targetMidY = childRect.top + childRect.height / 2;\n  const { width, height } = popoverRect;\n  let top: number;\n  let left: number;\n\n  switch (position) {\n    case \"left\":\n      top = targetMidY - height / 2;\n      left = childRect.left - spacing - width;\n      if (align === \"start\") {\n        top = childRect.top;\n      }\n      if (align === \"end\") {\n        top = childRect.bottom - height;\n      }\n      break;\n    case \"bottom\":\n      top = childRect.bottom + spacing;\n      left = targetMidX - width / 2;\n      if (align === \"start\") {\n        left = childRect.left;\n      }\n      if (align === \"end\") {\n        left = childRect.right - width;\n      }\n      break;\n    case \"right\":\n      top = targetMidY - height / 2;\n      left = childRect.right + spacing;\n      if (align === \"start\") {\n        top = childRect.top;\n      }\n      if (align === \"end\") {\n        top = childRect.bottom - height;\n      }\n      break;\n    default:\n      top = childRect.top - height - spacing;\n      left = targetMidX - width / 2;\n      if (align === \"start\") {\n        left = childRect.left;\n      }\n      if (align === \"end\") {\n        left = childRect.right - width;\n      }\n      break;\n  }\n\n  return {\n    top,\n    left,\n    width,\n    height,\n    right: left + width,\n    bottom: top + height,\n  };\n}\n\nexport function getNewPopoverRect(\n  {\n    position,\n    align,\n    childRect,\n    popoverRect,\n    boundaryRect,\n    spacing,\n    reposition,\n  }: GetNewPopoverRectProps,\n  boundaryInset: number\n) {\n  const rect = popoverRectForPosition(\n    position,\n    childRect,\n    popoverRect,\n    spacing,\n    align\n  );\n\n  const boundaryViolation =\n    reposition &&\n    ((position === \"top\" && rect.top < boundaryRect.top + boundaryInset) ||\n      (position === \"left\" && rect.left < boundaryRect.left + boundaryInset) ||\n      (position === \"right\" &&\n        rect.right > boundaryRect.right - boundaryInset) ||\n      (position === \"bottom\" &&\n        rect.bottom > boundaryRect.bottom - boundaryInset));\n\n  return {\n    rect,\n    boundaryViolation,\n  } as const;\n}\n\nexport const getNudgedPopoverRect = (\n  popoverRect: DOMRect,\n  boundaryRect: DOMRect,\n  boundaryInset: number\n) => {\n  const topBoundary = boundaryRect.top + boundaryInset;\n  const leftBoundary = boundaryRect.left + boundaryInset;\n  const rightBoundary = boundaryRect.right - boundaryInset;\n  const bottomBoundary = boundaryRect.bottom - boundaryInset;\n\n  let top = popoverRect.top < topBoundary ? topBoundary : popoverRect.top;\n  top =\n    top + popoverRect.height > bottomBoundary\n      ? bottomBoundary - popoverRect.height\n      : top;\n  let left = popoverRect.left < leftBoundary ? leftBoundary : popoverRect.left;\n  left =\n    left + popoverRect.width > rightBoundary\n      ? rightBoundary - popoverRect.width\n      : left;\n\n  return {\n    top,\n    left,\n    width: popoverRect.width,\n    height: popoverRect.height,\n    right: left + popoverRect.width,\n    bottom: top + popoverRect.height,\n  };\n};\n","import { ParentProps, onMount, onCleanup } from \"solid-js\";\nimport { Portal } from \"solid-js/web\";\n\nfunction PopoverPortal(\n  props: ParentProps<{\n    element: HTMLDivElement;\n    container: HTMLElement;\n    scoutElement: HTMLDivElement;\n  }>\n) {\n  onMount(() => {\n    props.container.appendChild(props.element);\n    props.container.appendChild(props.scoutElement);\n  });\n\n  onCleanup(() => {\n    props.container.removeChild(props.element);\n    props.container.removeChild(props.scoutElement);\n  });\n\n  return <Portal mount={props.element}>{props.children}</Portal>;\n}\n\nexport default PopoverPortal;\n","import { PopoverAlign, PopoverPosition } from \"./types\";\n\nexport const Constants = {\n  DEFAULT_ALIGN: \"center\" as PopoverAlign,\n  DEFAULT_POSITIONS: [\"top\", \"left\", \"right\", \"bottom\"] as PopoverPosition[],\n  EMPTY_CLIENT_RECT: {\n    top: 0,\n    left: 0,\n    bottom: 0,\n    height: 0,\n    right: 0,\n    width: 0,\n  } as ClientRect,\n} as const;\n","import {\n  onCleanup,\n  onMount,\n  ParentProps,\n  Show,\n  children,\n  createEffect,\n} from \"solid-js\";\nimport { createStore } from \"solid-js/store\";\nimport {\n  BoundaryViolations,\n  ContentLocation,\n  ContentLocationGetter,\n  PopoverPosition,\n  PopoverState,\n  PositionPopoverProps,\n} from \"./types\";\nimport {\n  createContainer,\n  getNewPopoverRect,\n  getNudgedPopoverRect,\n  rectsAreEqual,\n} from \"./utils\";\nimport PopoverPortal from \"./PopoverPortal\";\nimport { PopoverProps } from \"./types/\";\nimport { Constants } from \"./constants\";\n\nexport function Popover(props: ParentProps<PopoverProps>) {\n  let childRef: HTMLElement;\n  // previous popover state...\n  let prevIsOpen = false;\n  let prevPositions: PopoverPosition[] | undefined;\n  let prevContentLocation: ContentLocation | ContentLocationGetter | undefined;\n  let prevReposition = props.reposition;\n  const [popoverState, setPopoverState] = createStore<PopoverState>({\n    align: props.align,\n    nudgedLeft: 0,\n    nudgedTop: 0,\n    position:\n      props.positions.length > 0\n        ? props.positions[0]\n        : Constants.DEFAULT_POSITIONS[0],\n    spacing: props.spacing,\n    childRect: Constants.EMPTY_CLIENT_RECT,\n    popoverRect: Constants.EMPTY_CLIENT_RECT,\n    parentRect: Constants.EMPTY_CLIENT_RECT,\n    boundaryRect: Constants.EMPTY_CLIENT_RECT,\n    boundaryInset: props.boundaryInset,\n    violations: Constants.EMPTY_CLIENT_RECT,\n    hasViolations: false,\n  });\n\n  const popoverRef = createContainer(\n    {\n      position: \"fixed\",\n      overflow: \"visible\",\n      top: \"0px\",\n      left: \"0px\",\n    },\n    props.containerClassName ? props.containerClassName : \"solid-popover\"\n  );\n\n  const scoutRef = createContainer(\n    {\n      position: \"fixed\",\n      top: \"0px\",\n      left: \"0px\",\n      width: \"0px\",\n      height: \"0px\",\n      visibility: \"hidden\",\n    },\n    \"solid-tiny-popover-scout\"\n  );\n\n  function positionPopover({\n    contentLocation,\n    positionIndex = 0,\n    parentRect = props.parentElement.getBoundingClientRect() as DOMRect,\n    childRect = childRef?.getBoundingClientRect(),\n    boundaryRect = props.boundaryElement === props.parentElement\n      ? parentRect\n      : props.boundaryElement.getBoundingClientRect(),\n  }: PositionPopoverProps) {\n    let scoutRect = scoutRef?.getBoundingClientRect();\n    let popoverRect = popoverRef.getBoundingClientRect();\n    if (!childRect || !parentRect || !props.isOpen) {\n      return;\n    }\n\n    if (contentLocation) {\n      const { top: inputTop, left: inputLeft } =\n        typeof contentLocation === \"function\"\n          ? contentLocation({\n              childRect,\n              popoverRect,\n              parentRect,\n              boundaryRect,\n              spacing: props.spacing,\n              nudgedTop: 0,\n              nudgedLeft: 0,\n              boundaryInset: props.boundaryInset,\n              violations: Constants.EMPTY_CLIENT_RECT,\n              hasViolations: false,\n            })\n          : contentLocation;\n      const left = parentRect.left + inputLeft;\n      const top = parentRect.top + inputTop;\n\n      popoverRef.style.transform = `translate(${left - scoutRect.left}px, ${\n        top - scoutRect.top\n      }px)`;\n\n      setPopoverState({\n        childRect,\n        popoverRect,\n        parentRect,\n        boundaryRect,\n        spacing: props.spacing,\n        nudgedTop: 0,\n        nudgedLeft: 0,\n        boundaryInset: props.boundaryInset,\n        violations: Constants.EMPTY_CLIENT_RECT,\n        hasViolations: false,\n      });\n\n      return;\n    }\n\n    const isExhausted = positionIndex === props.positions.length;\n    const position = isExhausted\n      ? props.positions[0]\n      : props.positions[positionIndex];\n\n    const { rect, boundaryViolation } = getNewPopoverRect(\n      {\n        childRect,\n        popoverRect,\n        boundaryRect,\n        position,\n        align: props.align,\n        spacing: props.spacing,\n        reposition: props.reposition,\n      },\n      props.boundaryInset\n    );\n\n    if (boundaryViolation && props.reposition && !isExhausted) {\n      positionPopover({\n        positionIndex: positionIndex + 1,\n        childRect,\n        popoverRect,\n        parentRect,\n        boundaryRect,\n      });\n      return;\n    }\n\n    const { top, left, width, height } = rect;\n    const shouldNudge = props.reposition && !isExhausted;\n    const { left: nudgedLeft, top: nudgedTop } = getNudgedPopoverRect(\n      rect,\n      boundaryRect,\n      props.boundaryInset\n    );\n\n    let finalTop = top;\n    let finalLeft = left;\n\n    if (shouldNudge) {\n      finalTop = nudgedTop;\n      finalLeft = nudgedLeft;\n    }\n\n    popoverRef.style.transform = `translate(${finalLeft - scoutRect.left}px, ${\n      finalTop - scoutRect.top\n    }px)`;\n\n    const potentialViolations: BoundaryViolations = {\n      top: boundaryRect.top + props.boundaryInset - finalTop,\n      left: boundaryRect.left + props.boundaryInset - finalLeft,\n      right: finalLeft + width - boundaryRect.right + props.boundaryInset,\n      bottom: finalTop + height - boundaryRect.bottom + props.boundaryInset,\n    };\n\n    setPopoverState({\n      childRect,\n      popoverRect: {\n        top: finalTop,\n        left: finalLeft,\n        width,\n        height,\n        right: finalLeft + width,\n        bottom: finalTop + height,\n      } as DOMRect,\n      parentRect,\n      boundaryRect,\n      position,\n      align: props.align,\n      spacing: props.spacing,\n      nudgedTop: nudgedTop - top,\n      nudgedLeft: nudgedLeft - left,\n      boundaryInset: props.boundaryInset,\n      violations: {\n        top: potentialViolations.top <= 0 ? 0 : potentialViolations.top,\n        left: potentialViolations.left <= 0 ? 0 : potentialViolations.left,\n        right: potentialViolations.right <= 0 ? 0 : potentialViolations.right,\n        bottom:\n          potentialViolations.bottom <= 0 ? 0 : potentialViolations.bottom,\n      },\n      hasViolations:\n        potentialViolations.top > 0 ||\n        potentialViolations.left > 0 ||\n        potentialViolations.right > 0 ||\n        potentialViolations.bottom > 0,\n    });\n  }\n\n  function handleOnClickOutside(e: MouseEvent) {\n    if (props.isOpen && (e.target as Node).contains(popoverRef)) {\n      props.onClickOutside?.(e);\n    }\n  }\n\n  function handleWindowResize() {\n    if (childRef) {\n      const boundaryElement = props.boundaryElement\n        ? props.boundaryElement\n        : props.parentElement;\n      requestAnimationFrame(() =>\n        positionPopover({\n          contentLocation: props.contentLocation,\n          childRect: childRef?.getBoundingClientRect(),\n          parentRect: props.parentElement.getBoundingClientRect() as DOMRect,\n          boundaryRect:\n            props.boundaryElement === props.parentElement\n              ? (props.parentElement.getBoundingClientRect() as DOMRect)\n              : (boundaryElement.getBoundingClientRect() as DOMRect),\n        })\n      );\n    }\n  }\n\n  let shouldUpdate = true;\n\n  function updatePopover() {\n    const childRect = childRef?.getBoundingClientRect();\n    const popoverRect = popoverRef?.getBoundingClientRect();\n    if (\n      childRect != null &&\n      popoverRect != null &&\n      (!rectsAreEqual(childRect, {\n        top: popoverState.childRect.top,\n        left: popoverState.childRect.left,\n        width: popoverState.childRect.width,\n        height: popoverState.childRect.height,\n        bottom: popoverState.childRect.top + popoverState.childRect.height,\n        right: popoverState.childRect.left + popoverState.childRect.width,\n      } as DOMRect) ||\n        popoverRect.width !== popoverState.popoverRect.width ||\n        popoverRect.height !== popoverState.popoverRect.height ||\n        popoverState.spacing !== props.spacing ||\n        popoverState.align !== props.align ||\n        props.positions !== prevPositions ||\n        props.contentLocation !== prevContentLocation ||\n        props.reposition !== prevReposition)\n    ) {\n      const boundaryElement = props.boundaryElement\n        ? props.boundaryElement\n        : props.parentElement;\n      positionPopover({\n        contentLocation: props.contentLocation,\n        childRect,\n        parentRect: props.parentElement.getBoundingClientRect() as DOMRect,\n        boundaryRect:\n          props.boundaryElement === props.parentElement\n            ? (props.parentElement.getBoundingClientRect() as DOMRect)\n            : (boundaryElement.getBoundingClientRect() as DOMRect),\n      });\n    }\n\n    // TODO: factor prev checks out into the custom prev....s hook\n    if (props.positions !== prevPositions) {\n      prevPositions = props.positions;\n    }\n    if (props.contentLocation !== prevContentLocation) {\n      prevContentLocation = props.contentLocation;\n    }\n    if (props.reposition !== prevReposition) {\n      prevReposition = props.reposition;\n    }\n  }\n\n  function renderChildren() {\n    let c = children(() => props.children);\n    childRef = c() as HTMLElement;\n    return c();\n  }\n\n  // createRenderEffect || createEffect\n  createEffect(() => {\n    if (props.isOpen && shouldUpdate) {\n      window.requestAnimationFrame(updatePopover);\n      prevIsOpen = true;\n    }\n  });\n\n  onMount(() => {\n    window.addEventListener(\"click\", handleOnClickOutside, true);\n    window.addEventListener(\"resize\", handleWindowResize);\n  });\n\n  onCleanup(() => {\n    window.removeEventListener(\"click\", handleOnClickOutside, true);\n    window.removeEventListener(\"resize\", handleWindowResize);\n    shouldUpdate = false;\n  });\n\n  return (\n    <>\n      {renderChildren()}\n      <Show when={props.isOpen}>\n        <PopoverPortal\n          element={popoverRef}\n          container={props.parentElement}\n          scoutElement={scoutRef}\n        >\n          {typeof props.content !== \"function\"\n            ? props.content\n            : props.content(popoverState)}\n        </PopoverPortal>\n      </Show>\n    </>\n  );\n}\n","import { UseArrowContainerProps } from \"./types\";\n\nexport const createArrowContainer = ({\n  childRect,\n  popoverRect,\n  position,\n  arrowSize,\n  arrowColor,\n}: UseArrowContainerProps) => {\n  const arrowContainerStyle = {\n    padding: arrowSize,\n  };\n  const arrowStyle = {\n    position: \"absolute\",\n    // FIXME : use CSSProperties instead of any\n    ...((): any => {\n      const arrowWidth = arrowSize * 2;\n      let top =\n        childRect.top - popoverRect.top + childRect.height / 2 - arrowWidth / 2;\n      let left =\n        childRect.left -\n        popoverRect.left +\n        childRect.width / 2 -\n        arrowWidth / 2;\n\n      const lowerBound = arrowSize;\n      const leftUpperBound = popoverRect.width - arrowSize;\n      const topUpperBound = popoverRect.height - arrowSize;\n\n      left = left < lowerBound ? lowerBound : left;\n      left =\n        left + arrowWidth > leftUpperBound ? leftUpperBound - arrowWidth : left;\n      top = top < lowerBound ? lowerBound : top;\n      top = top + arrowWidth > topUpperBound ? topUpperBound - arrowWidth : top;\n\n      top = Number.isNaN(top) ? 0 : top;\n      left = Number.isNaN(left) ? 0 : left;\n\n      switch (position) {\n        case \"right\":\n          return {\n            borderTop: `${arrowSize}px solid transparent`,\n            borderBottom: `${arrowSize}px solid transparent`,\n            borderRight: `${arrowSize}px solid ${arrowColor}`,\n            left: 0,\n            top,\n          };\n        case \"left\":\n          return {\n            borderTop: `${arrowSize}px solid transparent`,\n            borderBottom: `${arrowSize}px solid transparent`,\n            borderLeft: `${arrowSize}px solid ${arrowColor}`,\n            right: 0,\n            top,\n          };\n        case \"bottom\":\n          return {\n            borderLeft: `${arrowSize}px solid transparent`,\n            borderRight: `${arrowSize}px solid transparent`,\n            borderBottom: `${arrowSize}px solid ${arrowColor}`,\n            top: 0,\n            left,\n          };\n        case \"top\":\n          return {\n            borderLeft: `${arrowSize}px solid transparent`,\n            borderRight: `${arrowSize}px solid transparent`,\n            borderTop: `${arrowSize}px solid ${arrowColor}`,\n            bottom: 0,\n            left,\n          };\n        default:\n          return {\n            display: \"hidden\",\n          };\n      }\n    })(),\n  };\n\n  return {\n    arrowContainerStyle,\n    arrowStyle,\n  };\n};\n","import { ArrowContainerProps } from \"./types\";\nimport { createArrowContainer } from \"./createArrowContainer\";\n\nexport function ArrowContainer(props: ArrowContainerProps) {\n  const {\n    childRect,\n    popoverRect,\n    position,\n    arrowColor,\n    arrowSize,\n    arrowClassName,\n    arrowStyle: externalArrowStyle,\n    className,\n    style: externalArrowContainerStyle,\n  } = props;\n  const { arrowContainerStyle, arrowStyle } = createArrowContainer({\n    childRect,\n    popoverRect,\n    position,\n    arrowColor,\n    arrowSize,\n  });\n\n  const mergedContainerStyle = {\n    ...arrowContainerStyle,\n    ...externalArrowContainerStyle,\n  };\n\n  const mergedArrowStyle = {\n    ...arrowStyle,\n    ...externalArrowStyle,\n  };\n\n  return (\n    <div class={className} style={mergedContainerStyle}>\n      <div style={mergedArrowStyle} class={arrowClassName} />\n      {props.children}\n    </div>\n  );\n}\n"],"names":["createContainer","containerStyle","containerClassName","container","document","createElement","className","Object","assign","style","rectsAreEqual","rectA","rectB","bottom","height","left","right","top","width","popoverRectForPosition","position","childRect","popoverRect","spacing","align","targetMidX","targetMidY","getNewPopoverRect","boundaryRect","reposition","boundaryInset","rect","boundaryViolation","getNudgedPopoverRect","topBoundary","leftBoundary","rightBoundary","bottomBoundary","PopoverPortal","props","onMount","appendChild","element","scoutElement","onCleanup","removeChild","_$createComponent","children","Constants","DEFAULT_ALIGN","DEFAULT_POSITIONS","EMPTY_CLIENT_RECT","Popover","childRef","prevPositions","prevContentLocation","prevReposition","popoverState","setPopoverState","createStore","nudgedLeft","nudgedTop","positions","length","parentRect","violations","hasViolations","popoverRef","overflow","scoutRef","visibility","positionPopover","contentLocation","positionIndex","parentElement","getBoundingClientRect","boundaryElement","scoutRect","isOpen","inputTop","inputLeft","transform","isExhausted","shouldNudge","finalTop","finalLeft","potentialViolations","handleOnClickOutside","e","target","contains","onClickOutside","handleWindowResize","requestAnimationFrame","shouldUpdate","updatePopover","renderChildren","c","createEffect","window","addEventListener","removeEventListener","_$memo","content","createArrowContainer","arrowSize","arrowColor","arrowContainerStyle","padding","arrowStyle","arrowWidth","lowerBound","leftUpperBound","topUpperBound","Number","isNaN","borderTop","borderBottom","borderRight","borderLeft","display","ArrowContainer","arrowClassName","externalArrowStyle","externalArrowContainerStyle","mergedContainerStyle","mergedArrowStyle","_$className","_$insert","_$effect","_$style"],"mappings":"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"}